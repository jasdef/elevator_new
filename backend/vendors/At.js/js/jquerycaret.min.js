!function(t,e){"function"==typeof define&&define.amd?define(["jquery"],function(o){return t.returnExportsGlobal=e(o)}):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(this,function(t){"use strict";var e,o,n,r,i,s,a,l,p,c,f;c="caret",e=function(){function e(t){this.$inputor=t,this.domInputor=this.$inputor[0]}return e.prototype.setPos=function(t){var e,o,n,r;return(r=p.getSelection())&&(n=0,o=!1,(e=function(t,i){var s,l,p,c,f,u;for(u=[],p=0,c=(f=i.childNodes).length;p<c&&(s=f[p],!o);p++)if(3===s.nodeType){if(n+s.length>=t){o=!0,(l=a.createRange()).setStart(s,t-n),r.removeAllRanges(),r.addRange(l);break}u.push(n+=s.length)}else u.push(e(t,s));return u})(t,this.domInputor)),this.domInputor},e.prototype.getIEPosition=function(){return this.getPosition()},e.prototype.getPosition=function(){var t,e;return e=this.getOffset(),t=this.$inputor.offset(),e.left-=t.left,e.top-=t.top,e},e.prototype.getOldIEPos=function(){var t,e;return e=a.selection.createRange(),(t=a.body.createTextRange()).moveToElementText(this.domInputor),t.setEndPoint("EndToEnd",e),t.text.length},e.prototype.getPos=function(){var t,e,o;return(o=this.range())?((t=o.cloneRange()).selectNodeContents(this.domInputor),t.setEnd(o.endContainer,o.endOffset),e=t.toString().length,t.detach(),e):a.selection?this.getOldIEPos():void 0},e.prototype.getOldIEOffset=function(){var t,e;return(t=a.selection.createRange().duplicate()).moveStart("character",-1),{height:(e=t.getBoundingClientRect()).bottom-e.top,left:e.left,top:e.top}},e.prototype.getOffset=function(e){var o,n,r,i,s;return p.getSelection&&(r=this.range())?(r.endOffset-1>0&&r.endContainer!==this.domInputor&&((o=r.cloneRange()).setStart(r.endContainer,r.endOffset-1),o.setEnd(r.endContainer,r.endOffset),n={height:(i=o.getBoundingClientRect()).height,left:i.left+i.width,top:i.top},o.detach()),n&&0!==(null!=n?n.height:void 0)||(o=r.cloneRange(),s=t(a.createTextNode("|")),o.insertNode(s[0]),o.selectNode(s[0]),n={height:(i=o.getBoundingClientRect()).height,left:i.left,top:i.top},s.remove(),o.detach())):a.selection&&(n=this.getOldIEOffset()),n&&(n.top+=t(p).scrollTop(),n.left+=t(p).scrollLeft()),n},e.prototype.range=function(){var t;if(p.getSelection)return(t=p.getSelection()).rangeCount>0?t.getRangeAt(0):null},e}(),o=function(){function e(t){this.$inputor=t,this.domInputor=this.$inputor[0]}return e.prototype.getIEPos=function(){var t,e,o,n,r,i,s;return e=this.domInputor,r=0,(i=a.selection.createRange())&&i.parentElement()===e&&(o=(n=e.value.replace(/\r\n/g,"\n")).length,(s=e.createTextRange()).moveToBookmark(i.getBookmark()),(t=e.createTextRange()).collapse(!1),r=s.compareEndPoints("StartToEnd",t)>-1?o:-s.moveStart("character",-o)),r},e.prototype.getPos=function(){return a.selection?this.getIEPos():this.domInputor.selectionStart},e.prototype.setPos=function(t){var e,o;return e=this.domInputor,a.selection?((o=e.createTextRange()).move("character",t),o.select()):e.setSelectionRange&&e.setSelectionRange(t,t),e},e.prototype.getIEOffset=function(t){var e,o,n,r;return o=this.domInputor.createTextRange(),t||(t=this.getPos()),o.move("character",t),{left:n=o.boundingLeft,top:r=o.boundingTop,height:e=o.boundingHeight}},e.prototype.getOffset=function(e){var o,n,r;return o=this.$inputor,a.selection?((n=this.getIEOffset(e)).top+=t(p).scrollTop()+o.scrollTop(),n.left+=t(p).scrollLeft()+o.scrollLeft(),n):(n=o.offset(),r=this.getPosition(e),{left:n.left+r.left-o.scrollLeft(),top:n.top+r.top-o.scrollTop(),height:r.height})},e.prototype.getPosition=function(t){var e,o,r,i,s,a,l;return e=this.$inputor,i=function(t){return t=t.replace(/<|>|`|"|&/g,"?").replace(/\r\n|\r|\n/g,"<br/>"),/firefox/i.test(navigator.userAgent)&&(t=t.replace(/\s/g,"&nbsp;")),t},void 0===t&&(t=this.getPos()),l=e.val().slice(0,t),r=e.val().slice(t),s="<span style='position: relative; display: inline;'>"+i(l)+"</span>",s+="<span id='caret' style='position: relative; display: inline;'>|</span>",s+="<span style='position: relative; display: inline;'>"+i(r)+"</span>",(a=new n(e)).create(s).rect()},e.prototype.getIEPosition=function(t){var e,o,n,r,i;return n=this.getIEOffset(t),o=this.$inputor.offset(),{left:r=n.left-o.left,top:i=n.top-o.top,height:e=n.height}},e}(),n=function(){function e(t){this.$inputor=t}return e.prototype.css_attr=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","borderTopWidth","boxSizing","fontFamily","fontSize","fontWeight","height","letterSpacing","lineHeight","marginBottom","marginLeft","marginRight","marginTop","outlineWidth","overflow","overflowX","overflowY","paddingBottom","paddingLeft","paddingRight","paddingTop","textAlign","textOverflow","textTransform","whiteSpace","wordBreak","wordWrap"],e.prototype.mirrorCss=function(){var e,o=this;return e={position:"absolute",left:-9999,top:0,zIndex:-2e4},"TEXTAREA"===this.$inputor.prop("tagName")&&this.css_attr.push("width"),t.each(this.css_attr,function(t,n){return e[n]=o.$inputor.css(n)}),e},e.prototype.create=function(e){return this.$mirror=t("<div></div>"),this.$mirror.css(this.mirrorCss()),this.$mirror.html(e),this.$inputor.after(this.$mirror),this},e.prototype.rect=function(){var t,e,o;return o={left:(e=(t=this.$mirror.find("#caret")).position()).left,top:e.top,height:t.height()},this.$mirror.remove(),o},e}(),r={contentEditable:function(t){return!(!t[0].contentEditable||"true"!==t[0].contentEditable)}},s={pos:function(t){return t||0===t?this.setPos(t):this.getPos()},position:function(t){return a.selection?this.getIEPosition(t):this.getPosition(t)},offset:function(t){var e;return e=this.getOffset(t)}},a=null,p=null,l=null,f=function(t){var e;return(e=null!=t?t.iframe:void 0)?(l=e,p=e.contentWindow,a=e.contentDocument||p.document):(l=void 0,p=window,a=document)},i=function(t){var e;a=t[0].ownerDocument,p=a.defaultView||a.parentWindow;try{return l=p.frameElement}catch(t){e=t}},t.fn.caret=function(n,i,a){var l;return s[n]?(t.isPlainObject(i)?(f(i),i=void 0):f(a),l=r.contentEditable(this)?new e(this):new o(this),s[n].apply(l,[i])):t.error("Method "+n+" does not exist on jQuery.caret")},t.fn.caret.EditableCaret=e,t.fn.caret.InputCaret=o,t.fn.caret.Utils=r,t.fn.caret.apis=s});